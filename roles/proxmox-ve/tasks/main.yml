---
- name: enable pve-no-subscription
  lineinfile:
    path: /etc/apt/sources.list
    line: 'deb http://download.proxmox.com/debian/pve bullseye pve-no-subscription'
    state: present

- name: disable pve-enterprise
  lineinfile:
    path: /etc/apt/sources.list.d/pve-enterprise.list
    regex: '^deb https://enterprise.proxmox.com/debian/pve bullseye pve-enterprise'
    line: '# deb https://enterprise.proxmox.com/debian/pve bullseye pve-enterprise'
    state: present

- name: disable lid close suspend
  lineinfile:
    path: /etc/systemd/logind.conf
    regex: 'HandleLidSwitch'
    line: 'HandleLidSwitch=ignore'
    state: present
  when: proxmox_ve_laptop|default(false)|bool
  notify: reboot
  